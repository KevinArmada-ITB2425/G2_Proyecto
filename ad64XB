<!DOCTYPE html>
<html>
  <head>
    <title>Error - Codeshare</title>
    <link
      type="text/css"
      href="/-/css/error-page.styles.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="error">
      <header class="header">
        <div class="group">
          <div class="span4">
            <a href="/"
              ><img
                alt="Codeshare logo"
                class="header__logo"
                src="/-/img/codeshare-logo.svg?v=v1.44.0"
            /></a>
          </div>
          <div class="span8">
            <ul class="navbar navbar--right header__navbar nav-item-pad"></ul>
          </div>
        </div>
      </header>
      <main>
        <h1 class="is-title">Please update your browser.</h1>
        <div class="error-container">
          <div>
            <div>
              Sorry but your browser is not compatible with Codeshare. Download
              the latest Chrome, Firefox, Edge, or Safari.
            </div>
            <br />
            <button
              id="use-anyway-button"
              style="display:none;"
              onClick="window._buttonOnClick"
            >
              Use Anyway
            </button>
          </div>
        </div>
      </main>
    </div>
    <script>
      var cookies = document.cookie
        .split(';')
        .map(function(c) {
          return c
            .trim()
            .split('=')
            .map(decodeURIComponent)
        })
        .reduce(function(a, b) {
          try {
            a[b[0]] = JSON.parse(b[1])
          } catch (e) {
            a[b[0]] = b[1]
          }
          return a
        }, {})
      var $btn = document.getElementById('use-anyway-button')
      if (!$btn) {
        alert('Sorry your browser is not compatible..')
      } else if (cookies.forceBrowserCompatibility) {
        // noop
      } else {
        // who the button
        $btn.style.display = 'block'
        $btn.onclick = function() {
          var endsWithSemicolon =
            document.cookie.length > 0 &&
            document.cookie.charAt(document.cookie.length - 1) === ';'
          if (!endsWithSemicolon) document.cookie = document.cookie + ';'
          // keep force compat for 2 weeks
          const date = new Date(Date.now() + 14 * 24 * 60 * 60 * 1000)
          document.cookie =
            'forceBrowserCompatibility=true; expires=' + date.toString()
          if (window.location.reload) {
            window.location.reload()
          } else {
            window.location.href = window.location.href
          }
          // to unset
          // document.cookie = 'forceBrowserCompatibility=; expires=Thu, 01 Jan 1970 00:00:00 GMT'
        }
      }
    </script>
  </body>
</html>
